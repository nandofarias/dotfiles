#!/bin/bash
# Wrapper for OpenClaw audio transcription via mlx_whisper
# Uses full paths since LaunchAgent has a limited PATH
FILE="$1"
BASENAME=$(basename "$FILE")
NOEXT="${BASENAME%.*}"
TMPDIR=$(mktemp -d)
/Users/ffarias/.local/share/mise/shims/mlx_whisper "$FILE" \
  --model mlx-community/whisper-large-v3-turbo \
  --output-format txt \
  --output-dir "$TMPDIR" \
  --verbose False \
  >/dev/null 2>&1
cat "$TMPDIR/$NOEXT.txt" 2>/dev/null
rm -rf "$TMPDIR"
